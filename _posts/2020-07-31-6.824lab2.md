---
layout: post
title: "6.824lab2解题"
date: 2020-07-25 10:30
categories:
    - 6.824
tags:
    - distribution
    - algorithm
---

6.824-2020 
Lab2A: election |
Lab2B: append new log entries |
Lab2C: persistent state

## 前言

Lab2的实验主题是Raft协议的实现，是Raft论文描述的核心之一。

本文打算把实验的设计用语言描述，以及总结一下我踩过的坑。

另外，Lab2是Lab3的基础，一定要多运行测试用例，确保每次都能全部通过。

先上实验结果，欢迎讨论。

```text
Test (2A): initial election ...
  ... Passed --   3.0  3   66   19486    0
Test (2A): election after network failure ...
  ... Passed --   4.4  3  144   30292    0
Test (2B): basic agreement ...
  ... Passed --   0.8  3   24    6546    3
Test (2B): RPC byte count ...
  ... Passed --   1.2  3   48  115010   11
Test (2B): agreement despite follower disconnection ...
  ... Passed --   3.6  3  104   28289    7
Test (2B): no agreement if too many followers disconnect ...
  ... Passed --   3.4  5  256   53794    3
Test (2B): concurrent Start()s ...
  ... Passed --   0.5  3   22    6934    6
Test (2B): rejoin of partitioned leader ...
  ... Passed --   5.9  3  208   55466    4
Test (2B): leader backs up quickly over incorrect follower logs ...
  ... Passed --  14.1  5 2200 1787636  102
Test (2B): RPC counts aren't too high ...
  ... Passed --   2.1  3   68   23086   12
Test (2C): basic persistence ...
  ... Passed --   3.0  3   80   22578    6
Test (2C): more persistence ...
  ... Passed --  14.5  5 1064  235052   16
Test (2C): partitioned leader and one follower crash, leader restarts ...
  ... Passed --   1.4  3   38   10422    4
Test (2C): Figure 8 ...
  ... Passed --  27.9  5 1307  306038   64
Test (2C): unreliable agreement ...
  ... Passed --   2.0  5 1072  397743  246
Test (2C): Figure 8 (unreliable) ...
  ... Passed --  34.3  5 10804 32933527  533
Test (2C): churn ...
  ... Passed --  16.4  5 4308 5680403  869
Test (2C): unreliable churn ...
  ... Passed --  16.2  5 1916 1277000  290
PASS
ok  	6.824/src/raft	154.914s
```

## 代码设计


